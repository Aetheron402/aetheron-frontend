<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>{% block title %}Aetheron{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- âœ… REQUIRED CSP (must come BEFORE all scripts) -->
  <meta
    http-equiv="Content-Security-Policy"
    content="
      default-src 'self';
      script-src
        'self'
        'unsafe-inline'
        https://cdn.tailwindcss.com
        https://cdn.jsdelivr.net
        https://esm.sh;
      style-src 'self' 'unsafe-inline';
      img-src 'self' data: https:;
      connect-src 'self' https://mainnet.helius-rpc.com;
      frame-ancestors 'none';
      object-src 'none';
    "
  />

  <script
    src="https://cdn.tailwindcss.com/3.4.1"
    integrity="sha384-Y6DgSq1sH2lUv7f5NQ1pCcyG8xv4aR7xVplgFMBfBd5x3pwmzNeU76A6kO4Yp83G"
    crossorigin="anonymous"
  ></script>

  <!-- Your own CSS -->
  <link rel="stylesheet" href="/static/css/style.css">

  <script
    src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.95.8/lib/index.iife.min.js"
    integrity="sha384-E6n2v9Y8Xg6fR8z4z5X8c9b8e7f6g5h4j3k2m1n0o9p8q7r6s5t4u3v2w1x0y9z"
    crossorigin="anonymous"
  ></script>

  <script type="module">
    import * as spl from "https://esm.sh/@solana/spl-token@0.3.11";
    window.splToken = spl;
  </script>

  <style>
    body { background-color: #030712; color: #e5e7eb; opacity: 0; transition: opacity .8s ease; }
    .btn { background:#22d3ee; color:#000; font-weight:600; padding:.5rem 1rem; border-radius:.5rem; transition: all .3s; }
    .btn:hover { background:#67e8f9; }
    .modal-bg { position: fixed; inset: 0; background: rgba(0,0,0,.65); display:none; align-items:center; justify-content:center; z-index:50; }
    .modal { background:#0b1220; border:1px solid rgba(56,189,248,.25); border-radius:1rem; width:min(480px, 92vw); padding:1.25rem; }
  </style>
</head>

<body class="font-sans">

<!-- =====================================
     HEADER (IDENTICAL TO shop.html)
====================================== -->
<header class="p-6 border-b border-cyan-900/30 flex justify-between items-center relative">

  <!-- LOGO -->
  <h1 onclick="window.location.href='/'"
      class="text-2xl font-bold text-cyan-400 cursor-pointer hover:text-cyan-300 transition">
    Aetheron Components
  </h1>

  <!-- DESKTOP NAV -->
  <nav class="desktop-nav hidden md:flex gap-6 text-sm items-center">
    <a href="https://github.com/Aetheron402" target="_blank" class="text-gray-400 hover:text-cyan-300">GitHub</a>
    <a href="https://x.com/Aetheron402" target="_blank" class="text-gray-400 hover:text-cyan-300">Aetheron on X</a>
    <a href="/learn" class="text-gray-400 hover:text-cyan-300">Learn</a>
    <a href="/roadmap" class="text-gray-400 hover:text-cyan-300">Roadmap</a>
    <a href="/legal" class="text-gray-400 hover:text-cyan-300">Legal</a>
    <a href="/aetheron-token" class="text-gray-400 hover:text-cyan-300">Aetheron Token</a>

    <button id="connect-wallet"
      class="bg-cyan-700 text-white px-3 py-1 rounded hover:bg-cyan-600 text-xs transition">
      Connect Wallet
    </button>
  </nav>

  <!-- MOBILE MENU BUTTON -->
  <button class="mobile-menu-btn md:hidden text-cyan-300 text-3xl" onclick="toggleMobileMenu()">â˜°</button>

  <!-- MOBILE NAV -->
  <nav id="mobile-nav"
     class="hidden flex-col gap-4 bg-[#030712]/95 border-t border-cyan-400/30 p-4 absolute left-0 right-0 top-full z-50 md:hidden">

    <a href="https://github.com/Aetheron402" target="_blank" class="text-gray-300">GitHub</a>
    <a href="https://x.com/Aetheron402" target="_blank" class="text-gray-300">Aetheron on X</a>
    <a href="/learn" class="text-gray-300">Learn</a>
    <a href="/roadmap" class="text-gray-300">Roadmap</a>
    <a href="/legal" class="text-gray-300">Legal</a>
    <a href="/aetheron-token" class="text-gray-300">Aetheron Token</a>

    <button id="mobile-connect-wallet"
      class="bg-cyan-700 text-white px-3 py-2 rounded">
      Connect Wallet
    </button>
  </nav>

</header>

<!-- =====================================
     PAGE CONTENT
====================================== -->
<main class="p-6">
  {% block content %}{% endblock %}
</main>

<!-- =====================================
     FOOTER
====================================== -->
<footer class="border-t border-cyan-900/30 mt-12 text-center text-sm text-gray-500 p-6">
  Â© 2025 Aetheron â€” Built on the X402 protocol.
  <div class="space-x-4 mt-2">

    <a href="https://github.com/Aetheron402" target="_blank"
       class="hover:text-cyan-300 transition">
       GitHub
    </a>

    <a href="https://x.com/Aetheron402" target="_blank"
       class="text-gray-400 hover:text-cyan-300 transition">
       Aetheron on X
    </a>

    <a href="/learn" class="hover:text-cyan-300">Learn</a>
    <a href="/roadmap" class="hover:text-cyan-300">Roadmap</a>
    <a href="/legal" class="hover:text-cyan-300">Legal</a>
    <a href="/aetheron-token" class="hover:text-cyan-300">Aetheron Token</a>
  </div>
</footer>


<!-- Wallet Selection Modal -->
<div id="wallet-select-modal" class="modal-bg" style="display:none;">
  <div class="modal text-center">
    <h3 class="text-cyan-300 text-lg font-semibold mb-4">Choose Wallet</h3>

    <!-- Phantom (Solana) â€” ACTIVE -->
    <button id="phantom-btn"
            class="btn mb-3 w-full flex items-center justify-center gap-2">
      Phantom Wallet
    </button>

    <!-- MetaMask (Ethereum) â€” DISABLED / COMING SOON -->
    <button class="btn w-full flex flex-col items-center justify-center gap-0.5
                   bg-gray-800 cursor-not-allowed opacity-60"
            disabled>
      <span>MetaMask</span>
      <span class="text-xs text-gray-400">Coming Q1 2026</span>
    </button>

    <p class="text-xs text-gray-400 mt-4 cursor-pointer hover:underline"
       onclick="document.getElementById('wallet-select-modal').style.display='none'">
       Cancel
    </p>
  </div>
</div>


<!-- =====================================
     WALLET JS (COPIED FROM shop.html)
====================================== -->
<script>
  const SOLANA_NETWORK = "https://mainnet.helius-rpc.com/?api-key=63f5896a-519d-4701-a181-654bcd2f5854";
  let currentWallet = "";
  let currentChain  = "";
  const walletBtn = document.getElementById("connect-wallet");

  function shorten(addr) {
    return "ðŸ”— " + addr.slice(0,4) + "..." + addr.slice(-4);
  }

  function updateWalletUI() {
    if (!currentWallet) {
      walletBtn.textContent = "Connect Wallet";
      return;
    }
    walletBtn.textContent = shorten(currentWallet);
  }

  async function connectPhantom() {
    if (!window.solana?.isPhantom) {
      alert("To continue, please open this site through the Phantom app browser on mobile, or use a desktop browser with the Phantom extension installed.");
      return;
    }

    try {
      await window.solana.disconnect().catch(()=>{});
      const res = await window.solana.connect({ onlyIfTrusted: false });
      currentWallet = res.publicKey.toString();
      currentChain = "solana";
      updateWalletUI();
    } catch(err) {
      console.error(err);
    }

    document.getElementById("wallet-select-modal").style.display = "none";
  }

  async function connectMetamask() {
    if (!window.ethereum) {
      alert("MetaMask not found");
      return;
    }

    try {
      await window.ethereum.request({
        method: "wallet_requestPermissions",
        params: [{ eth_accounts: {} }]
      });

      const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
      currentWallet = accounts[0];
      currentChain = "ethereum";
      updateWalletUI();
    } catch(err) {
      console.error(err);
    }

    document.getElementById("wallet-select-modal").style.display = "none";
  }

  // Click handler for wallet button
  walletBtn.addEventListener("click", () => {
    if (!currentWallet) {
      document.getElementById("wallet-select-modal").style.display = "flex";
    } else {
      if (confirm("Disconnect wallet?")) {
        currentWallet = "";
        currentChain = "";
        updateWalletUI();
      }
    }
  });

  document.getElementById("phantom-btn").onclick = connectPhantom;
  // document.getElementById("metamask-btn").onclick = connectMetamask;

  document.body.style.opacity = 1;
</script>

<script>
function toggleMobileMenu() {
  const nav = document.getElementById("mobile-nav");
  nav.classList.toggle("hidden");
  nav.classList.toggle("flex");
}

// Mobile wallet button mirrors desktop
document.addEventListener("DOMContentLoaded", () => {
  const mobileWalletBtn = document.getElementById("mobile-connect-wallet");
  const walletBtn = document.getElementById("connect-wallet");

  if (mobileWalletBtn && walletBtn) {
    mobileWalletBtn.addEventListener("click", () => walletBtn.click());
  }
});
</script>

</body>
</html>
